-- SQL Worksheet on Snowflake to encode the non int data 

-- Add encoded columns
ALTER TABLE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS ADD COLUMN Parental_Involvement_Encoded INT;
ALTER TABLE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS ADD COLUMN Access_to_Resources_Encoded INT;
ALTER TABLE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS ADD COLUMN Extracurricular_Activities_Encoded INT;
ALTER TABLE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS ADD COLUMN Motivation_Level_Encoded INT;
ALTER TABLE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS ADD COLUMN Internet_Access_Encoded INT;
ALTER TABLE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS ADD COLUMN Family_Income_Encoded INT;
ALTER TABLE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS ADD COLUMN Teacher_Quality_Encoded INT;
ALTER TABLE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS ADD COLUMN School_Type_Encoded INT;
ALTER TABLE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS ADD COLUMN Peer_Influence_Encoded INT;
ALTER TABLE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS ADD COLUMN Learning_Disabilities_Encoded INT;
ALTER TABLE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS ADD COLUMN Parental_Education_Level_Encoded INT;
ALTER TABLE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS ADD COLUMN Distance_from_Home_Encoded INT;
ALTER TABLE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS ADD COLUMN Gender_Encoded INT;

-- Update encoded columns
UPDATE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS SET Parental_Involvement_Encoded = CASE
    WHEN Parental_Involvement = 'Low' THEN 1
    WHEN Parental_Involvement = 'Medium' THEN 2
    WHEN Parental_Involvement = 'High' THEN 3
END;

UPDATE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS SET Access_to_Resources_Encoded = CASE
    WHEN Access_to_Resources = 'Low' THEN 1
    WHEN Access_to_Resources = 'Medium' THEN 2
    WHEN Access_to_Resources = 'High' THEN 3
END;

UPDATE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS SET Extracurricular_Activities_Encoded = CASE
    WHEN Extracurricular_Activities = 'Yes' THEN 1
    WHEN Extracurricular_Activities = 'No' THEN 0
END;

UPDATE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS SET Motivation_Level_Encoded = CASE
    WHEN Motivation_Level = 'Low' THEN 1
    WHEN Motivation_Level = 'Medium' THEN 2
    WHEN Motivation_Level = 'High' THEN 3
END;

UPDATE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS SET Internet_Access_Encoded = CASE
    WHEN Internet_Access = 'Yes' THEN 1
    WHEN Internet_Access = 'No' THEN 0
END;

UPDATE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS SET Family_Income_Encoded = CASE
    WHEN Family_Income = 'Low' THEN 1
    WHEN Family_Income = 'Medium' THEN 2
    WHEN Family_Income = 'High' THEN 3
END;

UPDATE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS SET Teacher_Quality_Encoded = CASE
    WHEN Teacher_Quality = 'Low' THEN 1
    WHEN Teacher_Quality = 'Medium' THEN 2
    WHEN Teacher_Quality = 'High' THEN 3
END;

UPDATE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS SET School_Type_Encoded = CASE
    WHEN School_Type = 'Public' THEN 1
    WHEN School_Type = 'Private' THEN 2
END;

UPDATE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS SET Peer_Influence_Encoded = CASE
    WHEN Peer_Influence = 'Negative' THEN 1
    WHEN Peer_Influence = 'Neutral' THEN 2
    WHEN Peer_Influence = 'Positive' THEN 3
END;

UPDATE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS SET Learning_Disabilities_Encoded = CASE
    WHEN Learning_Disabilities = 'Yes' THEN 1
    WHEN Learning_Disabilities = 'No' THEN 0
END;

UPDATE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS SET Parental_Education_Level_Encoded = CASE
    WHEN Parental_Education_Level = 'High School' THEN 1
    WHEN Parental_Education_Level = 'College' THEN 2
    WHEN Parental_Education_Level = 'Postgraduate' THEN 3
END;

UPDATE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS SET Distance_from_Home_Encoded = CASE
    WHEN Distance_from_Home = 'Near' THEN 1
    WHEN Distance_from_Home = 'Moderate' THEN 2
    WHEN Distance_from_Home = 'Far' THEN 3
END;

UPDATE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS SET Gender_Encoded = CASE
    WHEN Gender = 'Male' THEN 1
    WHEN Gender = 'Female' THEN 2
END;

DESC TABLE STUDENTPERFORMANCE.PUBLIC.STUDENTPERFORMANCEFACTORS;

